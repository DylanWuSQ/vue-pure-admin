import{d as K,r as C,t as V,A as E,o as L,F as se,n as le,aC as oe,s as ie,e as T,i as H,l as p,aD as de,x as re,h as R,j as m,g as c,k as d,b as fe,aE as me,Z as w,aF as ce}from"./index-d9cc66e5.js";const W=[{avatar:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIADIAMgMBIgACEQEDEQH/xAAbAAEAAgMBAQAAAAAAAAAAAAAFBAYBAgMAB//aAAgBAQAAAAD7HU4ObhMC3AnlYvY8ISwA+6WDOd4/RA96FVeF66BOVWB3TsAOgZC27wv/xAAYAQEBAQEBAAAAAAAAAAAAAAACAwQAAf/aAAgBAhAAAAC3sw8uyRDQPV//xAAYAQADAQEAAAAAAAAAAAAAAAAAAgMBBP/aAAgBAxAAAACQ7LfmoUTNvFf/xAA0EAACAQMBBAcHAwUAAAAAAAABAgMABBESBRMxQRAhIjJRYbEUIzRCUnOBM3KSU2KRoeH/2gAIAQEAAT8AmmSCJpHOAoq6vZp8lmITkgonSQCMZxikkdGDxsVbxFbK2l7TGUkwHQfy6Ln4if7jetbcdglvH9TFv40hD71CGzlQpAyACRkt4VcxojxOdIj06GzwA5VKkilGUdjUcNxD9XlwI5g1Bfm0u4nC5UHDeYNWu0LS4B3D6mHHIwaufiJ/uN61tm6Et6GPCIbv8mtqi4gtrFkzjeuxIGRq+TP4orI1jpK+8MHAfVprYcM8kVysmoIGiwG8UfVgVcwh1ecDGiYcvlNWk7W9zDKucqwyPEVOczzfvb1q/wBkXWqR4Sja8nDHGCajAEagHIAx/jourmK0haaV9KrWyrFZLRZJ07MqNhc8Q3M/irfZFlaOGQF2HzOc1cACeYD+o3r0XptYEJKAyMx06TgsxOaupr+MhkIQk6TlfPlkVNCIxBc3A9onLjRG/WtWV1BPFlRp09TpzBHLoufiJ/uN69G05JLxt8C2ksQpTiAMHIq0mQz6HnMnZwurBwBRhKTLLK5Y6Oz/AGf9qwla3u4TykBRh/sdFx8RN9xvWpri43Unv5O6fmNSSSCHGtsb0DGfKrFm3zdZ7o9RUskhMnbbu+NLJJrh7bfqJz869onxjfSY/callk3knvG7x51//8QAIxEAAgEEAQMFAAAAAAAAAAAAAQIRAAMSMRAEIXETMjNBUf/aAAgBAgEBPwBMUTNv3tSdQrgZDYpwMmx0N8PdFv0iBMAyKS4QroF99JcxDhhMntwxgUCoJIER90jZCeG2PBpvjNWtHzx//8QAIBEAAgICAgIDAAAAAAAAAAAAAQIAERASAyEyM0GBkf/aAAgBAwEBPwBtmbURuErdRb1W/nCIW3vqMgJVr8YyWVIyvYG/5CKwJze36jY//9k=",name:"\u7F8E\u7EEA",text:"\u9A6C\u4EC0\u4E48\u6885\uFF1F"},{avatar:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIADIAMgMBIgACEQEDEQH/xAAbAAACAwEBAQAAAAAAAAAAAAAABQIDBAEGB//aAAgBAQAAAAD65hzG3WLcATfCbHYQ9IY0uiEfRkU1IOr+RoUG1ornWj7Y6//EABgBAQADAQAAAAAAAAAAAAAAAAQAAgUD/9oACAECEAAAACEf3IJba51tGDNq/wD/xAAYAQEAAwEAAAAAAAAAAAAAAAAEAQMFAv/aAAgBAxAAAABSg0MWQdj+c6VozP/EAC0QAAIBAwMBBgUFAAAAAAAAAAECEQADBBASMUEiUVJhcZEFExQhgSAyQoKx/9oACAEBAAE/AKu5oEi2A3meKOXf8cfgV9Xe2kEgyOeCKsZSXAqs0XP91z7+wC3MSCzeg/RbuG06uO8T6a5kNkOOu0CpUXWQMdo4kQRPQihPd9tH+4jXIw0yDukq0RNHFu2/iOVku0pfx7foHt91MttbMyN7njqQDo3BPkdWEqRJEjkV8QOV2LVq2xBBlkoq+y181CrgHn1nXHffZQ+UH8aEwCaEoJP9qzbe+ySOUO7XCuxca2f5CR6jS477H7bftPWt7+NvekdzbWXYyo60rvtXtHgda3v4j71Yd/qLPaPJ6+Vb38be9f/EACYRAAECBAQHAQAAAAAAAAAAAAECAwAEEBIREzFSITNBQlFhgXL/2gAIAQIBAT8AffKDYjXqYznd5hhwuI46ijjOOaSfaYUm232Ik9F/KKQFRMN2LHgiJVdrmG6s32fYa5iP0Kf/xAAmEQABAgQFBAMAAAAAAAAAAAABAgMAEBESBBNCUoEhMTNhUXFy/9oACAEDAQE/AGGAoXK4EZLWwQ+2G19Oxk28RlhI9GEqur9xi9HMm3C2qtAfRhhy9J+axiUXIrtnhdfEOeNf5Mv/2Q==",name:"\u535A\u58EB",text:"\u9A6C\u4E1C\u4EC0\u4E48\uFF1F"},{avatar:"data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAoKCgoKCgsMDAsPEA4QDxYUExMUFiIYGhgaGCIzICUgICUgMy03LCksNy1RQDg4QFFeT0pPXnFlZXGPiI+7u/sBCgoKCgoKCwwMCw8QDhAPFhQTExQWIhgaGBoYIjMgJSAgJSAzLTcsKSw3LVFAODhAUV5PSk9ecWVlcY+Ij7u7+//CABEIADIAMgMBIgACEQEDEQH/xAAxAAACAgMBAAAAAAAAAAAAAAAABgQFAQIHAwEBAAMBAAAAAAAAAAAAAAAAAwABAgT/2gAMAwEAAhADEAAAAI7CsPnN1VeZ0okpTbSWASKzwmMPRy3PuuWhpv4KvQ7pcJYTUb+hdLQYWJoaVU+RU3jcXiaoegAhWOAPeeaBd1wGtf/EAC4QAAIBAwIEBAUFAQAAAAAAAAECAwAEEQUhBhASMRMiQWEUI3KBoSAzQlFSkv/aAAgBAQABPwDTxidHHbdTyZGjdkcYYelBGKM4HlUgH7/osXInRfQsK0q18abxGHkj/JrV0KXrEfzUGtLiE0F1G48r4GfcVJDJFI0TbMp52W91D9VXt42mWQCu0QUqHZQC7SyDIRA22QO5NXkFyLeFpnWRggYsMZw/+ioAPsRVlOtrpsshx+6d2OFGw3J/oVK897YR6nbfORCTkp0OVQ7lRk5Aq5gMZSVR8qVepfbPpy0jDSRyEZxIg/6JrjKJytlEEJ63uJD7ttXB6Tn41bhW8Mwxxjqzt3OBWrx+Bw9fQsRvIgBzjYutcP3F8upWVmZZltvjFPQW22BqeAJpHh+kWyeyhsL+KXS9RcB1WLpYZGSc4NcKwxTrcRy+qrj2IJIqe3S5AEsSOAcgMobB+9Lb9KhVAAHYCntRIjI6hkYYZWGQRUGm2ltMssVsiSKCAVGMZqWFZ4fDY4XYn7ULaEgF182N/Me9cIuI3kY9gFodLAEHINFgKDKdqwK1LVotOMSsnWz5JAPYUeJZyTiKMVwv2n+la08npcZOBjke3LVWZtRuizE4kI5f/8QAIBEBAAIBAgcAAAAAAAAAAAAAAQARAwIQEiAhMTJBcf/aAAgBAgEBPwDL5HzkadfX0RDjmTSUJtks1MqWpVypk7uxt//EACARAQABAwMFAAAAAAAAAAAAAAEAAhEhAxATEiIxYXH/2gAIAQMBAT8A0m1L9l+2++Sg9sF45p1N7M6iUJYwM5GYW4ZmZT4Njb//2Q==",name:"\u67DA\u5B50",text:"\u4EC0\u4E48\u51AC\u6885\uFF1F"}],N=["1","2","3","4","5","6","7","8","9"],z=()=>N.map((u,s)=>{const g=s%3;return{avatar:W[g].avatar,name:W[g].name,text:u}});function pe(u,s,g="modelValue",r){return E({get:()=>u[g],set:a=>{s(`update:${g}`,r?r(a):a)}})}var Y=K({components:{},props:{danmus:{type:Array,required:!0,default:()=>[]},channels:{type:Number,default:0},autoplay:{type:Boolean,default:!0},loop:{type:Boolean,default:!1},useSlot:{type:Boolean,default:!1},debounce:{type:Number,default:100},speeds:{type:Number,default:200},randomChannel:{type:Boolean,default:!1},fontSize:{type:Number,default:18},top:{type:Number,default:4},right:{type:Number,default:0},isSuspend:{type:Boolean,default:!1},extraStyle:{type:String,default:""}},emits:["list-end","play-end","update:danmus"],setup(u,{emit:s,slots:g}){let r=C(document.createElement("div")),a=C(document.createElement("div"));const f=C(0),Q=C(0);let k=0;const M=C(0),x=C(0),v=C(0),I=C(!1),y=C(!1),i=C({}),e=pe(u,s,"danmus"),h=V({channels:E(()=>u.channels||M.value),autoplay:E(()=>u.autoplay),loop:E(()=>u.loop),useSlot:E(()=>u.useSlot),debounce:E(()=>u.debounce),randomChannel:E(()=>u.randomChannel)}),l=V({height:E(()=>x.value),fontSize:E(()=>u.fontSize),speeds:E(()=>u.speeds),top:E(()=>u.top),right:E(()=>u.right)});L(()=>{S()}),se(()=>{G()});function S(){D(),u.isSuspend&&X(),h.autoplay&&o()}function D(){f.value=r.value.offsetWidth,Q.value=r.value.offsetHeight}function o(){y.value=!1,k||(k=setInterval(()=>U(),h.debounce))}function U(){if(!y.value&&e.value.length)if(v.value>e.value.length-1){const n=a.value.children.length;h.loop&&n<v.value&&(s("list-end"),v.value=0,j())}else j()}function j(){const n=h.loop?v.value%e.value.length:v.value;let t=document.createElement("div");h.useSlot?t=P(n).$el:(t.innerHTML=e.value[n],t.setAttribute("style",u.extraStyle),t.style.fontSize=`${l.fontSize}px`,t.style.lineHeight=`${l.fontSize}px`),t.classList.add("dm"),a.value.appendChild(t),t.style.opacity="0",le(()=>{l.height||(x.value=t.offsetHeight),h.channels||(M.value=Math.floor(Q.value/(l.height+l.top)));let A=J(t);if(A>=0){const B=t.offsetWidth,F=l.height;t.classList.add("move"),t.style.opacity="1";const b=f.value/l.speeds;t.style.animationDuration=`${b}s`,t.style.top=A*(F+l.top)+"px",t.style.width=B+l.right+"px",t.style.setProperty("--dm-left-offset",`-${f.value}px`),t.dataset.index=`${n}`,t.addEventListener("animationend",()=>{Number(t.dataset.index)===e.value.length-1&&!h.loop&&s("play-end",t.dataset.index),a.value.removeChild(t)}),t.classList.length>0&&v.value++}else t.classList.length>0&&a.value.removeChild(t)})}function P(n){const t=e.value[n],A=n;return oe({render(){return ie("div",{},[g.dm&&g.dm({danmu:t,index:A})])}}).mount(document.createElement("div"))}function J(n){let t=[...Array(h.channels).keys()];h.randomChannel&&(t=t.sort(()=>.5-Math.random()));for(let A of t){const B=i.value[A];if(B&&B.length)for(let F=0;F<B.length;F++){const b=_(B[F])-10;if(b<=(n.offsetWidth-B[F].offsetWidth)*.88||b<=0)break;if(F===B.length-1)return i.value[A].push(n),n.addEventListener("animationend",()=>i.value[A].splice(0,1)),A%h.channels}else return i.value[A]=[n],n.addEventListener("animationend",()=>i.value[A].splice(0,1)),A%h.channels}return-1}function _(n){const t=n.offsetWidth||parseInt(n.style.width),A=n.getBoundingClientRect().right||a.value.getBoundingClientRect().right+t;return a.value.getBoundingClientRect().right-A}function O(){clearInterval(k),k=0}function X(){let n=[];a.value.addEventListener("mousemove",t=>{let A=t.target;A.className.includes("dm")||(A=A.closest(".dm")||A),A.className.includes("dm")&&(A.classList.add("pause"),n.push(A))}),a.value.addEventListener("mouseout",t=>{let A=t.target;A.className.includes("dm")||(A=A.closest(".dm")||A),A.className.includes("dm")&&(A.classList.remove("pause"),n.forEach(B=>{B.classList.remove("pause")}),n=[])})}function G(){O(),v.value=0}function Z(){x.value=0,S()}function q(){i.value={},a.value.innerHTML="",y.value=!0,I.value=!1,G()}function $(){y.value=!0}function ee(n){if(v.value===e.value.length)return e.value.push(n),e.value.length-1;{const t=v.value%e.value.length;return e.value.splice(t,0,n),t+1}}function te(n){return e.value.push(n),e.value.length-1}function ne(){return!y.value}function Ae(){I.value=!1}function ae(){I.value=!0}function ue(){D();const n=a.value.getElementsByClassName("dm");for(let t=0;t<n.length;t++)n[t].style.setProperty("--dm-left-offset",`-${f}px`)}return{container:r,dmContainer:a,hidden:I,paused:y,danmuList:e,getPlayState:ne,resize:ue,play:o,pause:$,stop:q,show:Ae,hide:ae,reset:Z,add:ee,push:te}}});const ge={ref:"container",class:"vue-danmaku"};function ve(u,s,g,r,a,f){return T(),H("div",ge,[p("div",{ref:"dmContainer",class:["danmus",{show:!u.hidden},{paused:u.paused}]},null,2),de(u.$slots,"default")],512)}function he(u,s){s===void 0&&(s={});var g=s.insertAt;if(!(!u||typeof document>"u")){var r=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css",g==="top"&&r.firstChild?r.insertBefore(a,r.firstChild):r.appendChild(a),a.styleSheet?a.styleSheet.cssText=u:a.appendChild(document.createTextNode(u))}}var Ce=`.vue-danmaku {
  position: relative;
  overflow: hidden;
}
.vue-danmaku .danmus {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  opacity: 0;
  -webkit-transition: all 0.3s;
  transition: all 0.3s;
}
.vue-danmaku .danmus.show {
  opacity: 1;
}
.vue-danmaku .danmus.paused .dm.move {
  animation-play-state: paused;
}
.vue-danmaku .danmus .dm {
  position: absolute;
  right: 0;
  font-size: 20px;
  color: #ddd;
  white-space: pre;
  transform: translateX(100%);
  transform-style: preserve-3d;
}
.vue-danmaku .danmus .dm.move {
  will-change: transform;
  animation-name: moveLeft;
  animation-timing-function: linear;
  animation-play-state: running;
}
.vue-danmaku .danmus .dm.pause {
  animation-play-state: paused;
  z-index: 10;
}
@keyframes moveLeft {
  from {
    transform: translateX(100%);
  }
  to {
    transform: translateX(var(--dm-left-offset));
  }
}
@-webkit-keyframes moveLeft {
  from {
    -webkit-transform: translateX(100%);
  }
  to {
    -webkit-transform: translateX(var(--dm-left-offset));
  }
}`;he(Ce);Y.render=ve;Y.__file="src/lib/Danmaku.vue";const Ee=Y,Be={class:"card-header"},Qe={class:"font-medium"},ye={class:"flex gap-5"},Fe={class:"danmu-item"},ke=["src"],xe={class:"main"},Ie={class:"ml-5"},we={class:"ml-5"},Me={class:"ml-5"},Se={class:"flex"},De=K({name:"Danmaku"}),Re=K({...De,setup(u){const s=C(null),g=C(z()),r=C("");let a=0;const f=V({channels:5,useSlot:!0,loop:!0,speeds:200,fontSize:20,top:10,right:0,debounce:100,randomChannel:!0});L(()=>{window.onresize=()=>I()}),re(()=>{window.onresize=null});function Q(i){switch(i){case"play":s.value.play();break;case"pause":s.value.pause();break;case"stop":s.value.stop();break;case"show":s.value.show();break;case"hide":s.value.hide();break;case"reset":s.value.reset();break}}function k(i){f.useSlot=i,g.value=i?z():N,setTimeout(()=>{s.value.stop(),s.value.play()})}function M(i){f.speeds<=10&&i===-10||(f.speeds+=i,s.value.reset())}function x(i){f.fontSize+=i,s.value.reset()}function v(i){!f.channels&&i===-1||(f.channels+=i)}function I(){a&&clearTimeout(a),a=window.setTimeout(()=>{s.value.resize()},500)}function y(){if(!r.value)return;const i=f.useSlot?{avatar:"https://i.loli.net/2021/01/17/xpwbm3jKytfaNOD.jpg",name:"\u4F60",text:r.value}:r.value;s.value.add(i),r.value=""}return(i,e)=>{const h=R("el-link"),l=R("el-button"),S=R("el-input"),D=R("el-card");return T(),H(D,null,{header:m(()=>[c("div",Be,[c("span",Qe,[d(" \u5F39\u5E55\u7EC4\u4EF6\uFF0C\u91C7\u7528\u5F00\u6E90\u7684 "),p(h,{href:"https://github.com/hellodigua/vue-danmaku/tree/vue3",target:"_blank",style:{"font-size":"16px",margin:"0 4px 5px"}},{default:m(()=>[d(" vue-danmaku ")]),_:1})])])]),default:m(()=>[c("div",ye,[p(fe(Ee),me({ref_key:"danmaku",ref:s,class:"demo",danmus:g.value,"onUpdate:danmus":e[0]||(e[0]=o=>g.value=o),isSuspend:""},f),{dm:m(({danmu:o,index:U})=>[c("div",Fe,[c("img",{class:"img",src:o.avatar},null,8,ke),c("span",null,w(U)+w(o.name)+"\uFF1A",1),c("span",null,w(o.text),1)])]),_:1},16,["danmus"]),c("div",xe,[c("p",null,[d(" \u64AD\u653E\uFF1A "),p(l,{onClick:e[1]||(e[1]=o=>Q("play"))},{default:m(()=>[d("\u64AD\u653E")]),_:1}),p(l,{onClick:e[2]||(e[2]=o=>Q("pause"))},{default:m(()=>[d("\u6682\u505C")]),_:1}),p(l,{onClick:e[3]||(e[3]=o=>Q("stop"))},{default:m(()=>[d("\u505C\u6B62")]),_:1})]),c("p",null,[d(" \u6A21\u5F0F\uFF1A "),p(l,{onClick:e[4]||(e[4]=o=>k(!0))},{default:m(()=>[d("\u5F39\u5E55 slot")]),_:1}),p(l,{onClick:e[5]||(e[5]=o=>k(!1))},{default:m(()=>[d("\u666E\u901A\u6587\u672C")]),_:1})]),c("p",null,[d(" \u663E\u793A\uFF1A "),p(l,{onClick:e[6]||(e[6]=o=>Q("show"))},{default:m(()=>[d("\u663E\u793A")]),_:1}),p(l,{onClick:e[7]||(e[7]=o=>Q("hide"))},{default:m(()=>[d("\u9690\u85CF")]),_:1})]),c("p",null,[d(" \u901F\u5EA6\uFF1A "),p(l,{onClick:e[8]||(e[8]=o=>M(-10))},{default:m(()=>[d("\u51CF\u901F")]),_:1}),p(l,{onClick:e[9]||(e[9]=o=>M(10))},{default:m(()=>[d("\u589E\u901F")]),_:1}),c("span",Ie,"\u5F53\u524D\u901F\u5EA6\uFF1A"+w(f.speeds)+"\u50CF\u7D20/s",1)]),c("p",null,[d(" \u5B57\u53F7\uFF1A "),p(l,{disabled:f.useSlot,onClick:e[10]||(e[10]=o=>x(-1))},{default:m(()=>[d(" \u7F29\u5C0F ")]),_:1},8,["disabled"]),p(l,{disabled:f.useSlot,onClick:e[11]||(e[11]=o=>x(1))},{default:m(()=>[d(" \u653E\u5927 ")]),_:1},8,["disabled"]),c("span",we,"\u5F53\u524D\u5B57\u53F7\uFF1A"+w(f.fontSize)+"px",1)]),c("p",null,[d(" \u8F68\u9053\uFF1A "),p(l,{onClick:e[12]||(e[12]=o=>v(-1))},{default:m(()=>[d("-1")]),_:1}),p(l,{onClick:e[13]||(e[13]=o=>v(1))},{default:m(()=>[d("+1")]),_:1}),p(l,{onClick:e[14]||(e[14]=o=>v(-f.channels))},{default:m(()=>[d(" \u586B\u6EE1 ")]),_:1}),c("span",Me,"\u5F53\u524D\u8F68\u9053\uFF1A"+w(f.channels),1)]),c("p",Se,[p(S,{type:"text",placeholder:"\u8F93\u5165\u8BC4\u8BBA\u540E\uFF0C\u56DE\u8F66\u53D1\u9001\u5F39\u5E55",modelValue:r.value,"onUpdate:modelValue":e[15]||(e[15]=o=>r.value=o),onKeyup:ce(y,["enter"])},null,8,["modelValue","onKeyup"])])])])]),_:1})}}});export{Re as default};
